<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Réserver une table</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center text-primary mb-4">Réserver une table</h1>
    <form method="POST" action="http://ec2-51-20-132-244.eu-north-1.compute.amazonaws.com:5000/submit-reservation">
        <div class="mb-3">
            <label for="peopleCount" class="form-label">Nombre de personnes :</label>
            <input type="number" class="form-control" id="peopleCount" name="peopleCount" required>
        </div>

        <div class="mb-3">
            <label for="classicCount" class="form-label">Option classique :</label>
            <input type="number" class="form-control" id="classicCount" name="classicCount" required>
        </div>

        <div class="mb-3">
            <label for="tastingCount" class="form-label">Option dégustation :</label>
            <input type="number" class="form-control" id="tastingCount" name="tastingCount" required>
        </div>

        <div class="mb-3">
            <label for="wineSupplementCount" class="form-label">Supplément vin :</label>
            <input type="number" class="form-control" id="wineSupplementCount" name="wineSupplementCount" required>
        </div>

        <div class="mb-3">
            <label for="reservationDate" class="form-label">Date :</label>
            <input type="date" class="form-control" id="reservationDate" name="reservationDate" required>
        </div>

        <div class="mb-3">
            <label for="reservationTime" class="form-label">Heure :</label>
            <input type="time" class="form-control" id="reservationTime" name="reservationTime" required>
        </div>

        <div class="mb-3">
            <label for="firstName" class="form-label">Prénom :</label>
            <input type="text" class="form-control" id="firstName" name="firstName" required>
        </div>

        <div class="mb-3">
            <label for="lastName" class="form-label">Nom :</label>
            <input type="text" class="form-control" id="lastName" name="lastName" required>
        </div>

        <div class="mb-3">
            <label for="email" class="form-label">Email :</label>
            <input type="email" class="form-control" id="email" name="email" required>
        </div>

        <div class="mb-3">
            <label for="phone" class="form-label">Téléphone :</label>
            <input type="tel" class="form-control" id="phone" name="phone" required>
        </div>

        <button type="submit" class="btn btn-primary w-100">Envoyer</button>
    </form>
</div>
<script>
    async function submitForm(event) {
        event.preventDefault();

        const formData = new FormData(event.target);
        const data = Object.fromEntries(formData.entries());

        try {
            const response = await fetch("http://ec2-51-20-132-244.eu-north-1.compute.amazonaws.com:5000/submit-reservation", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error("Erreur lors de la soumission.");
            }

            const result = await response.json();

            // Vérifiez que les données de réservation sont présentes
            if (result.reservation) {
                // Stocker les données dans localStorage
                localStorage.setItem("reservation", JSON.stringify(result.reservation));

                // Redirection vers la page de résultat
                window.location.href = "/result";
            } else {
                throw new Error("Aucune réservation trouvée.");
            }
        } catch (error) {
            console.error(error);
            alert("Une erreur est survenue. Veuillez réessayer.");
        }
    }

    document.getElementById("reservationForm").addEventListener("submit", submitForm);
</script>


</body>
</html>
